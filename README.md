# Iterative Multiscale Molecular Dynamics (iMMD) in OpenMM: Accelerating Conformational Sampling of Biomolecular Systems by Iterating All-Atom and Coarse-Grained Molecular Dynamics Simulations
Here, we combine the strengths of all-atom (AA) and coarse-grained (CG) MD simulations to develop the iterative multiscale MD (iMMD) simulation workflow in OpenMM by iterating between AA and CG MD simulations to enhance the sampling of biomolecular conformations. The AA-CG-AA iterations are repeated over multiple cycles, facilitating the accelerated sampling of biomolecular conformations at a CG level, while the finer atomistic interactions are refined with AA simulators. 
The current implementation of iMMD is in the OpenMM simulation package but can be easily adopted for GROMACS. The initial input for iMMD can be a simple atomistic PDB structure of the protein of interest if the simulation system is mere solution or only involves common membrane phospholipid molecules, including DLPC, DLPE, DMPC, DOPC, DPPC, POPC, and POPE. iMMD in OpenMM can then automatically embed the protein in the phospholipid membrane of choice and/or solvate the simulation system with water and ions. If the simulation system involves non-phospholipid molecules, the user should set up simulation systems outside iMMD and provide the topology and coordinate files to start iMMD simulations.
The all-atom (AA) MD simulation is then carried out, using the CHARMM36m as the default force field parameter set. The final frame of the AA simulation is converted to its coarse-grained (CG) representation using the Martinize2 framework for protein and backward python script for the other components of the simulation system. The CG MD simulation is then performed to facilitate the transitions from one conformational state to another, with MARTINI3 as the default force field parameter set. The final frame of the CG simulation is converted back to its AA representation using the mstool python package for the protein, common lipids, water, and ions and backward python script for the uncommon lipid molecules. The AA-CG-AA cycles are repeated to continue the iMMD simulation. 
![Figure-1](https://github.com/user-attachments/assets/a6c95652-9458-4bf4-a13b-78a0c4bd2d3e)





